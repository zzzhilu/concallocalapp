# ConCall â€” æœ¬åœ°ç«¯ AI å³æ™‚æœƒè­°ç´€éŒ„ç³»çµ±

<p align="center">
  <strong>ğŸ™ï¸ å³æ™‚èªéŸ³è¾¨è­˜ Â· ğŸŒ å³æ™‚ç¿»è­¯ Â· ğŸ—£ï¸ èªªè©±è€…è¾¨è­˜ Â· ğŸ“ AI æ‘˜è¦</strong>
</p>

> **å®Œå…¨é›¢ç·šã€å®Œå…¨æœ¬åœ°** â€” æ‰€æœ‰ AI æ¨¡å‹å‡åœ¨æ‚¨çš„ GPU ä¸Šé‹è¡Œï¼ŒéŸ³è¨Šèˆ‡æœƒè­°è³‡æ–™ä¸æœƒé›¢é–‹æ‚¨çš„é›»è…¦ã€‚

---

## âœ¨ åŠŸèƒ½ç‰¹è‰²

| åŠŸèƒ½ | æŠ€è¡“ | ç¡¬é«” |
|------|------|------|
| **å³æ™‚èªéŸ³è¾¨è­˜ (ASR)** | Faster-Whisper (large-v3, float16) | GPU 0 |
| **èªéŸ³æ´»å‹•åµæ¸¬ (VAD)** | Silero VAD (ONNX) | GPU 0 |
| **èªªè©±è€…è¾¨è­˜ (Diarization)** | Pyannote 3.1 | GPU 0 |
| **å³æ™‚ç¿»è­¯** | Qwen3-32B-AWQ via vLLM | GPU 1 |
| **æœƒè­°æ‘˜è¦** | Qwen3-32B-AWQ via vLLM | GPU 1 |
| **æ¼¸é€²å¼ç¿»è­¯ä¿®æ­£** | å¥å°¾åµæ¸¬ + MD5 å»é‡ | CPU |
| **æœƒè­°ç´€éŒ„æŒä¹…åŒ–** | SQLite | CPU |

## ğŸ—ï¸ ç³»çµ±æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Browser (UI)                         â”‚
â”‚         WebSocket éŸ³è¨Šä¸²æµ  â†â†’  å³æ™‚è½‰å¯«/ç¿»è­¯é¡¯ç¤º            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ :8000
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              app-core (FastAPI + WebSocket)                  â”‚
â”‚   â€¢ Web UI (VS Code-like IDE é¢¨æ ¼)                          â”‚
â”‚   â€¢ WebSocket éŸ³è¨Šæ¥æ”¶ â†’ Redis                              â”‚
â”‚   â€¢ æœƒè­°ç´€éŒ„ CRUD API                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Redis Pub/Sub            â”‚ Redis Queue
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  worker-asr     â”‚       â”‚  worker-intelligence              â”‚
â”‚  (GPU 0)        â”‚       â”‚  (CPU â†’ calls vLLM API)           â”‚
â”‚  â€¢ Whisper ASR  â”‚       â”‚  â€¢ å³æ™‚ç¿»è­¯ (æ¼¸é€²å¼ä¿®æ­£)           â”‚
â”‚  â€¢ Silero VAD   â”‚       â”‚  â€¢ æœƒè­°æ‘˜è¦ç”¢ç”Ÿ                    â”‚
â”‚  â€¢ Pyannote     â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚ HTTP API
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚  worker-llm (vLLM)                â”‚
                          â”‚  (GPU 1 â€” ç¨ä½”)                   â”‚
                          â”‚  â€¢ Qwen3-32B-AWQ                  â”‚
                          â”‚  â€¢ OpenAI-compatible API           â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ ç¡¬é«”éœ€æ±‚

| é …ç›® | æœ€ä½éœ€æ±‚ |
|------|----------|
| **GPU** | 2Ã— NVIDIA RTX 4090 (24GB VRAM each) |
| **RAM** | 32 GB |
| **å„²å­˜** | 50 GB (æ¨¡å‹ä¸‹è¼‰) |
| **OS** | Windows 10/11 æˆ– Linux (æ”¯æ´ Docker + NVIDIA Container Toolkit) |

> **GPU åˆ†é…**ï¼šGPU 0 é‹è¡Œ ASR + VAD + Diarizationï¼ˆç´„ 6GB VRAMï¼‰ï¼ŒGPU 1 ç¨ä½”é‹è¡Œ Qwen3-32B-AWQï¼ˆç´„ 24GB VRAMï¼‰ã€‚

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. å‰ç½®æ¢ä»¶

- [Docker Desktop](https://www.docker.com/products/docker-desktop/) + [NVIDIA Container Toolkit](https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/install-guide.html)
- [HuggingFace Token](https://huggingface.co/settings/tokens)ï¼ˆPyannote æ¨¡å‹éœ€è¦ï¼‰

### 2. ç’°å¢ƒè¨­å®š

```bash
# è¤‡è£½å°ˆæ¡ˆ
git clone https://github.com/your-username/concall-local.git
cd concall-local

# è¤‡è£½ç’°å¢ƒè®Šæ•¸ç¯„æœ¬
cp .env.example .env

# ç·¨è¼¯ .envï¼Œå¡«å…¥æ‚¨çš„ HF_TOKEN å’Œæ¨¡å‹å¿«å–è·¯å¾‘
# HF_TOKEN=hf_your_token_here
# HF_CACHE_DIR=/path/to/your/models
```

### 3. å•Ÿå‹•æœå‹™

```bash
# å»ºæ§‹ä¸¦å•Ÿå‹•æ‰€æœ‰æœå‹™
docker compose up -d --build

# æª¢æŸ¥æœå‹™ç‹€æ…‹
docker compose ps

# æŸ¥çœ‹æ—¥èªŒ
docker compose logs -f
```

### 4. é–‹å§‹ä½¿ç”¨

ç€è¦½å™¨æ‰“é–‹ **http://localhost:8000**

1. é¸æ“‡æœƒè­°æ¨¡å¼ï¼ˆä¸­æ–‡é€å­—ç¨¿ / ä¸­è‹±ç¿»è­¯ / è‹±ä¸­ç¿»è­¯ï¼‰
2. é»æ“Š **â–· Start Recording** é–‹å§‹éŒ„éŸ³
3. å³æ™‚æŸ¥çœ‹è½‰å¯«çµæœã€ç¿»è­¯ã€èªªè©±è€…æ¨™ç±¤
4. é»æ“Š **â–  Stop** åœæ­¢ï¼Œå¯ç”Ÿæˆ AI æ‘˜è¦
5. é»æ“Š **Save Meeting** å„²å­˜æœƒè­°ç´€éŒ„

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
concall-local/
â”œâ”€â”€ core/                    # app-core æœå‹™
â”‚   â”œâ”€â”€ main.py              #   FastAPI ä¸»ç¨‹å¼ + WebSocket
â”‚   â”œâ”€â”€ database.py          #   SQLite æœƒè­°æŒä¹…åŒ–
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ static/              #   å‰ç«¯è³‡æº
â”‚       â”œâ”€â”€ index.html        #     VS Code-like UI
â”‚       â”œâ”€â”€ style.css         #     æš—è‰²ä¸»é¡Œæ¨£å¼
â”‚       â””â”€â”€ app.js            #     å‰ç«¯é‚è¼¯
â”œâ”€â”€ worker-asr/              # ASR + VAD + Diarization æœå‹™
â”‚   â”œâ”€â”€ main.py              #   Whisper + Silero + Pyannote
â”‚   â”œâ”€â”€ download_models.py   #   æ¨¡å‹ä¸‹è¼‰è…³æœ¬
â”‚   â””â”€â”€ Dockerfile
â”œâ”€â”€ worker-intelligence/     # ç¿»è­¯ + æ‘˜è¦æœå‹™
â”‚   â”œâ”€â”€ main.py              #   æ¼¸é€²å¼ç¿»è­¯ + æ‘˜è¦ç”¢ç”Ÿ
â”‚   â””â”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml       # æœå‹™ç·¨æ’
â”œâ”€â”€ .env.example             # ç’°å¢ƒè®Šæ•¸ç¯„æœ¬
â””â”€â”€ README.md
```

## âš™ï¸ ç’°å¢ƒè®Šæ•¸

| è®Šæ•¸ | èªªæ˜ | é è¨­å€¼ |
|------|------|--------|
| `HF_TOKEN` | HuggingFace API Token | *(å¿…å¡«)* |
| `HF_CACHE_DIR` | æ¨¡å‹å¿«å–ç›®éŒ„ | `./models` |
| `REDIS_URL` | Redis é€£ç·š URL | `redis://redis:6379/0` |
| `ASR_MODEL_SIZE` | Whisper æ¨¡å‹å¤§å° | `large-v3` |
| `ASR_COMPUTE_TYPE` | Whisper è¨ˆç®—ç²¾åº¦ | `float16` |
| `LLM_MODEL` | LLM æ¨¡å‹åç¨± | `Qwen/Qwen3-32B-AWQ` |
| `DIARIZATION_INTERVAL` | èªªè©±è€…è¾¨è­˜è§¸ç™¼é–“éš” | `30` (ç§’) |

## ğŸ”’ å®‰å…¨æ€§

- **å®Œå…¨é›¢ç·šé‹è¡Œ** â€” æ‰€æœ‰ AI æ¨è«–åœ¨æœ¬æ©Ÿ GPU å®Œæˆï¼ŒéŸ³è¨Šè³‡æ–™ä¸æœƒä¸Šå‚³è‡³ä»»ä½•é›²ç«¯æœå‹™
- **ç¶²è·¯éš”é›¢** â€” Redis å’Œ vLLM API ç«¯å£åƒ…ç¶å®š `127.0.0.1`ï¼Œå¤–éƒ¨ç„¡æ³•å­˜å–
- **XSS é˜²è­·** â€” æ‰€æœ‰ä½¿ç”¨è€…è¼¸å…¥ç¶“é `escapeHtml()` è™•ç†
- **SQL æ³¨å…¥é˜²è­·** â€” æ‰€æœ‰è³‡æ–™åº«æ“ä½œä½¿ç”¨åƒæ•¸åŒ–æŸ¥è©¢
- **æ•æ„Ÿè³‡è¨Š** â€” `.env` å·²åŠ å…¥ `.gitignore`ï¼ŒToken ä¸æœƒè¢«æäº¤

## ğŸ› ï¸ é–‹ç™¼

```bash
# åƒ…é‡å»ºç‰¹å®šæœå‹™
docker compose build --no-cache app-core
docker compose up -d app-core

# æŸ¥çœ‹ç‰¹å®šæœå‹™æ—¥èªŒ
docker compose logs -f worker-asr
docker compose logs -f worker-intelligence
```

## ğŸ“„ æˆæ¬Š

MIT License
