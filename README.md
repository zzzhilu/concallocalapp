# ConCall Local Model â€” æœ¬åœ°ç«¯ AI å³æ™‚æœƒè­°ç´€éŒ„èˆ‡ç¿»è­¯ç³»çµ±

> å®Œå…¨é›¢ç·šã€æœ¬åœ°éƒ¨ç½²çš„å³æ™‚èªéŸ³è¾¨è­˜ã€èªªè©±è€…åˆ†é›¢ã€ç¿»è­¯èˆ‡æœƒè­°æ‘˜è¦ç³»çµ±ã€‚

## ğŸ—ï¸ ç³»çµ±æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Browser Web UI                          â”‚
â”‚              (éº¥å…‹é¢¨éŒ„éŸ³ â†’ WebSocket ä¸²æµ)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ WebSocket (float32 PCM)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               app-core (CPU Only, :8000)                     â”‚
â”‚      FastAPI + WebSocket + Static Files + Translation        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ LPUSH audio_queue                  â”‚ SUBSCRIBE *
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Redis (:6379)                             â”‚
â”‚              Message Broker + Buffer                        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ BRPOP
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  worker-asr (GPU 0)  â”‚        app-core â”€â”€HTTPâ”€â”€â–¶ worker-llm
â”‚  â€¢ Faster-Whisper    â”‚                          (GPU 1, :8001)
â”‚  â€¢ Silero VAD        â”‚                          Qwen2.5-32B
â”‚  â€¢ Pyannote 3.1      â”‚                          OpenAI API
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ–¥ï¸ ç¡¬é«”éœ€æ±‚

| é …ç›® | è¦æ ¼ |
|------|------|
| GPU 0 | NVIDIA RTX 4090 (24GB) â€” ASR + VAD + Diarization â‰ˆ 5.6GB |
| GPU 1 | NVIDIA RTX 4090 (24GB) â€” LLM (Qwen2.5-32B) â‰ˆ 24GB |
| RAM | â‰¥ 32GB |
| Docker | â‰¥ 24.0 + NVIDIA Container Toolkit |
| OS | Windows 11 (WSL2) / Linux (Ubuntu 22.04) |

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. ç’°å¢ƒæº–å‚™

```bash
# ç¢ºèª GPU é©…å‹•
nvidia-smi

# ç¢ºèª Docker + NVIDIA Container Toolkit
docker run --rm --gpus all nvidia/cuda:12.1.1-runtime-ubuntu22.04 nvidia-smi
```

### 2. è¨­å®šç’°å¢ƒè®Šæ•¸

```bash
cp .env.example .env
# ç·¨è¼¯ .envï¼Œå¡«å…¥ HuggingFace Token
```

### 3. é ä¸‹è¼‰æ¨¡å‹ (å¯é¸ï¼Œç´„ 20GB)

```bash
# åœ¨ worker-asr å®¹å™¨ä¸­é ä¸‹è¼‰ ASR æ¨¡å‹
docker compose run --rm worker-asr python download_models.py

# vLLM æœƒåœ¨é¦–æ¬¡å•Ÿå‹•æ™‚è‡ªå‹•ä¸‹è¼‰ Qwen2.5 æ¨¡å‹
```

### 4. å•Ÿå‹•æœå‹™

**æ–¹æ³• A â€” ä¸€éµå•Ÿå‹• (æ¨è–¦)ï¼š**

```
é›™æ“Š scripts\start_app.bat
```

å®ƒæœƒè‡ªå‹•ï¼šå•Ÿå‹• Docker â†’ ç­‰å¾…æœå‹™å°±ç·’ â†’ æ‰“é–‹ Chrome App Mode â†’ é—œé–‰è¦–çª—æ™‚è‡ªå‹•åœæ­¢æœå‹™ã€‚

**æ–¹æ³• B â€” æ‰‹å‹•å•Ÿå‹•ï¼š**

```bash
docker compose up -d
docker compose logs -f

# ç­‰å¾… vLLM è¼‰å…¥æ¨¡å‹ (ç´„ 3-5 åˆ†é˜)
# ç¢ºèª: curl http://localhost:8001/v1/models

# é–‹å•Ÿç€è¦½å™¨å‰å¾€ http://localhost:8000
```

**åœæ­¢æœå‹™ï¼š**

```bash
# æ–¹æ³• A é—œé–‰ Chrome è¦–çª—å³è‡ªå‹•åœæ­¢
# æ–¹æ³• B æ‰‹å‹•åœæ­¢ï¼š
scripts\cleanup.bat
# æˆ–è€…ï¼šdocker compose stop
```

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
Concallapp_localmodel/
â”œâ”€â”€ docker-compose.yml          # 4 services é…ç½®
â”œâ”€â”€ .env / .env.example         # ç’°å¢ƒè®Šæ•¸
â”œâ”€â”€ core/                       # app-core æœå‹™ (Web UI + Gateway + ç¿»è­¯/æ‘˜è¦)
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ main.py                 # FastAPI app (WebSocket + Redis + LLM client)
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ redis_keys.py           # Redis key å¸¸æ•¸
â”‚   â”œâ”€â”€ audio_utils.py          # éŸ³è¨Šå·¥å…·å‡½å¼
â”‚   â””â”€â”€ static/                 # å‰ç«¯ UI (HTML/CSS/JS/PWA)
â”œâ”€â”€ workers/
â”‚   â””â”€â”€ asr/                    # ASR + Diarization (GPU 0)
â”‚       â”œâ”€â”€ Dockerfile
â”‚       â”œâ”€â”€ main.py
â”‚       â””â”€â”€ download_models.py  # æ¨¡å‹é ä¸‹è¼‰
â””â”€â”€ scripts/
    â”œâ”€â”€ start_app.bat           # ä¸€éµå•Ÿå‹• (Docker + Chrome App Mode)
    â””â”€â”€ cleanup.bat             # åœæ­¢æœå‹™ã€é‡‹æ”¾ GPU VRAM
```

## ğŸ–¥ï¸ Desktop Launcher (Windows)

æä¾›é¡ä¼¼åŸç”Ÿæ‡‰ç”¨ç¨‹å¼çš„ä½¿ç”¨é«”é©—ï¼š

1. **å»ºç«‹æ¡Œé¢æ·å¾‘**ï¼šå³éµ `create_shortcut.ps1` â†’ ä»¥ PowerShell åŸ·è¡Œ
2. **å•Ÿå‹•**ï¼šé›™æ“Šæ¡Œé¢ä¸Šçš„ `ConCall AI` æ·å¾‘
   - è‡ªå‹•å•Ÿå‹• Docker æœå‹™
   - ç­‰å¾… app-core å¥åº·æª¢æŸ¥é€šé
   - ä»¥ Chrome App Mode æ‰“é–‹ Web UI
3. **é—œé–‰**ï¼šé—œé–‰ Chrome è¦–çª— â†’ è‡ªå‹•åœæ­¢æ‰€æœ‰æœå‹™ã€é‡‹æ”¾ GPU VRAM

## ğŸ“„ License

MIT
